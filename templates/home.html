{% extends "base.html" %}

{% block title %}Tunnelgrain - Private VPN Service{% endblock %}

{% block content %}
<div class="content-wrapper">
    <!-- Hero Section -->
    <section class="text-center mb-5">
        <h1 class="page-title">Private VPN Access</h1>
        <p class="page-subtitle">
            WireGuard-based VPN service for privacy-conscious users. 
            Test our service for 15 minutes, then purchase monthly access.
        </p>
        
        <div class="row justify-content-center mb-4">
            <div class="col-md-8">
                <div class="d-flex gap-3 justify-content-center flex-wrap">
                    <button class="btn-primary-clean" onclick="purchaseVPN()">
                        Purchase Monthly Access - $9.99
                    </button>
                    <a href="{{ url_for('test') }}" class="btn-secondary-clean">
                        Try 15-Minute Test
                    </a>
                </div>
            </div>
        </div>
        
        <div class="row text-center">
            <div class="col-md-6 mb-2">
                <small id="monthly-status" class="text-muted">
                    <span class="status-dot status-online"></span>
                    Loading monthly slots...
                </small>
            </div>
            <div class="col-md-6 mb-2">
                <small id="test-status" class="text-muted">
                    <span class="status-dot status-online"></span>
                    Loading test slots...
                </small>
            </div>
        </div>
    </section>

    <!-- Service Details -->
    <section class="mb-5">
        <div class="row">
            <div class="col-lg-6 mb-4">
                <div class="card-clean p-4 h-100">
                    <h3 class="h5 mb-3">What You Get</h3>
                    <ul class="feature-list">
                        <li>
                            <i class="fas fa-shield-alt"></i>
                            WireGuard protocol encryption
                        </li>
                        <li>
                            <i class="fas fa-clock"></i>
                            30-day access period
                        </li>
                        <li>
                            <i class="fas fa-server"></i>
                            High-speed server access
                        </li>
                        <li>
                            <i class="fas fa-mobile-alt"></i>
                            Works on all devices
                        </li>
                        <li>
                            <i class="fas fa-eye-slash"></i>
                            No activity logging
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="col-lg-6 mb-4">
                <div class="card-clean p-4 h-100">
                    <h3 class="h5 mb-3">How It Works</h3>
                    <ol class="list-unstyled">
                        <li class="mb-3">
                            <strong>1. Test First</strong><br>
                            <small class="text-muted">Try our 15-minute test to verify compatibility</small>
                        </li>
                        <li class="mb-3">
                            <strong>2. Purchase</strong><br>
                            <small class="text-muted">Secure payment via Stripe for monthly access</small>
                        </li>
                        <li class="mb-3">
                            <strong>3. Download</strong><br>
                            <small class="text-muted">Get your WireGuard config file instantly</small>
                        </li>
                        <li class="mb-3">
                            <strong>4. Connect</strong><br>
                            <small class="text-muted">Import to WireGuard app and start browsing</small>
                        </li>
                    </ol>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing -->
    <section class="mb-5">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <div class="card-clean p-4 text-center">
                    <h3 class="h4 mb-3">Monthly VPN Access</h3>
                    <div class="mb-3">
                        <span class="h2 text-dark">$9.99</span>
                        <span class="text-muted">/month</span>
                    </div>
                    <p class="text-muted mb-4">
                        One-time payment for 30 days of VPN access. 
                        No recurring billing, no automatic renewals.
                    </p>
                    <button class="btn-primary-clean w-100" onclick="purchaseVPN()">
                        Purchase Now
                    </button>
                    <small class="text-muted d-block mt-2">
                        Secure payment processing via Stripe
                    </small>
                </div>
            </div>
        </div>
    </section>

    <!-- Important Notes -->
    <section class="mb-5">
        <div class="card-clean p-4">
            <h3 class="h5 mb-3">Service Notes</h3>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted">Limited Slots</h6>
                    <p class="small">We maintain only 10 active VPN slots to ensure optimal performance for all users.</p>
                </div>
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted">No Refunds</h6>
                    <p class="small">Test our service first with the 15-minute trial. Sales are final except for technical failures.</p>
                </div>
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted">Technical Support</h6>
                    <p class="small">Contact us for setup assistance or technical issues via our support channels.</p>
                </div>
                <div class="col-md-6 mb-3">
                    <h6 class="text-muted">Fair Usage</h6>
                    <p class="small">Service is provided for legitimate personal use. Abuse may result in service termination.</p>
                </div>
            </div>
        </div>
    </section>
</div>
{% endblock %}

{% block scripts %}
<script>
    async function purchaseVPN() {
        try {
            const response = await fetch('/create-checkout-session', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            });
            
            const data = await response.json();
            
            if (data.error) {
                alert('Error: ' + data.error);
                return;
            }
            
            window.location.href = data.checkout_url;
            
        } catch (error) {
            console.error('Error:', error);
            alert('Error creating checkout session. Please try again.');
        }
    }
</script>
{% endblock %}